library(ggplot2)
library(reshape2)
library(scales)
library(dplyr)

# rf->700
rf700EF<- c(1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9805825242718447, 0.9813084112149533, 1.0, 0.8737864077669902, 0.8785046728971962, 0.9074074074074074, 0.7669902912621359, 0.719626168224299, 0.7407407407407407, 0.5922330097087378, 0.5420560747663551, 0.5555555555555556, 0.4368932038834951, 0.308411214953271, 0.46296296296296297, 0.3592233009708738, 0.2803738317757009, 0.26851851851851855, 0.17475728155339806, 0.028037383177570093, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)

baseEF = c(1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9805825242718447, 0.9813084112149533, 1.0, 0.8737864077669902, 0.8785046728971962, 0.9074074074074074, 0.7669902912621359, 0.719626168224299, 0.7407407407407407, 0.5922330097087378, 0.5420560747663551, 0.5555555555555556, 0.4368932038834951, 0.308411214953271, 0.3055555555555556, 0.1650485436893204, 0.056074766355140186, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)

fd6EF = c(1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9805825242718447, 0.9813084112149533, 1.0, 0.8737864077669902, 0.8785046728971962, 0.9074074074074074, 0.7669902912621359, 0.719626168224299, 0.7407407407407407, 0.5922330097087378, 0.5420560747663551, 0.5555555555555556, 0.4368932038834951, 0.308411214953271, 0.46296296296296297, 0.4077669902912621, 0.4392523364485981, 0.4537037037037037, 0.4368932038834951, 0.411214953271028, 0.46296296296296297, 0.4368932038834951, 0.32710280373831774, 0.4074074074074074, 0.3592233009708738, 0.2523364485981308, 0.2777777777777778, 0.24271844660194175, 0.102803738317757, 0.1574074074074074, 0.10679611650485436, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)

selfishEF = c(1.0, 0.9926738364665925, 0.9671447627656802, 0.94541212264821, 0.9272970514355118, 0.9177787778466466, 0.9066441628497526, 0.898064195282269, 0.895753509573336, 0.891812063900028, 0.8883062274497779, 0.8906036918110962, 0.8892365081386656, 0.88800418106904, 0.8910542993483186, 0.8808260536884278, 0.870685665412178, 0.868823013024813, 0.8581266598546077, 0.8444771219993443, 0.8355044884075126, 0.8203675968294469, 0.8030529277978087, 0.7919369174589355, 0.7707061288662348, 0.7497376569299214, 0.7387275461291434, 0.7389966936037156, 0.7446017644334338, 0.7490603899295883, 0.7525275322812256, 0.756333675547863, 0.7592405550287982, 0.762623095125041, 0.765528186225768, 0.7673137259141382, 0.76997299771765, 0.7725302857094956, 0.773305878788062, 0.7745408504896238, 0.7763260139934226, 0.7770658435470084, 0.7778415575887184, 0.7788417388337284, 0.7789783716427992, 0.7799498138929292, 0.7797664563131669, 0.7786253030741994, 0.7794494937481556, 0.7804983518629902)

twoYearsEF = c(1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9805825242718447, 0.9813084112149533, 1.0, 0.8737864077669902, 0.8785046728971962, 0.9074074074074074, 0.7669902912621359, 0.719626168224299, 0.7407407407407407, 0.5922330097087378, 0.5420560747663551, 0.5555555555555556, 0.4368932038834951, 0.308411214953271, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)

grazingAAEF = c(1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9805825242718447, 0.9813084112149533, 1.0, 0.8737864077669902, 0.8785046728971962, 0.9074074074074074, 0.7669902912621359, 0.719626168224299, 0.7407407407407407, 0.5922330097087378, 0.5420560747663551, 0.5555555555555556, 0.4368932038834951, 0.308411214953271, 0.3055555555555556, 0.30097087378640774, 0.24299065420560748, 0.2962962962962963, 0.30097087378640774, 0.2336448598130841, 0.3055555555555556, 0.1941747572815534, 0.09345794392523364, 0.1388888888888889, 0.06796116504854369, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)

#dataframe distribué par année 
#qsk3g1,qsk3,qsk3g3,qsk3g4,
#qsk2g1, qsk2, qsk2g3, qsk2g4
df2 <- data.frame(rf700EF)
df2$years <- 1:nrow(df2)
df2 <- melt(df2, id.vars ="years")
df2$type <- "RF=700, t=25"


df3 <- data.frame(baseEF)
df3$years <- 1:nrow(df3)
df3 <- melt(df3, id.vars ="years")
df3$type <- "Base"

df4 <- data.frame(fd6EF)
df4$years <- 1:nrow(df4)
df4 <- melt(df4, id.vars ="years")
df4$type <- "FD=6, t=25"

df5 <- data.frame(selfishEF)
df5$years <- 1:nrow(df5)
df5 <- melt(df5, id.vars ="years")
df5$type <- "No Loan, t=25"

df6 <- data.frame(twoYearsEF)
df6$years <- 1:nrow(df6)
df6 <- melt(df6, id.vars ="years")
df6$type <- "Two years, t=25"


df7 <- data.frame(grazingAAEF)
df7$years <- 1:nrow(df7)
df7 <- melt(df7, id.vars ="years")
df7$type <- "Grazing Anywhere, anytime"


dfTot = rbind(df2,df4, df5, df6, df7, df3)

ggplot(dfTot, aes(x=years))+
  geom_line( aes(y=value, color=variable))+
  theme_minimal()+
  xlab("Years")+
  ylab("Effective fallow")+
  geom_vline(xintercept=25, linetype='dotted', col = 'black')+
  scale_color_manual(name = "Switch, Years = 25", 
                     values=c( "blue", "darkgreen","#D95F02", "purple", "#1B9E77", "red" ),
                     labels=c("Rainfall = 700mm", "6 Faidherbia/ha","No Loan, no food donation", "2 years rotation", "Grazing anywhere anytime", "Base"))
