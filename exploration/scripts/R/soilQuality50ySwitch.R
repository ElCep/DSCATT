library(ggplot2)
library(reshape2)
library(scales)
library(dplyr)

# rf->700
rf700SQ<- c(1.030338267684484, 0.9926738364665928, 0.9671447627656811, 0.9454121226482108, 0.9272970514355118, 0.917778777846647, 0.9066441628497522, 0.8980641952822689, 0.8957535095733361, 0.8918120639000282, 0.8883062274497779, 0.8906036918110962, 0.8892365081386658, 0.8880041810690391, 0.8910542993483181, 0.8808260536884281, 0.8706856654121783, 0.8688230130248128, 0.8581266598546067, 0.8444771219993454, 0.8355044884075128, 0.8203675968294467, 0.8030529277978086, 0.7919369174589354, 0.770706128866235, 0.7475693846345209, 0.7362817362016392, 0.7241232091897662, 0.7059819205270863, 0.6918639627134797, 0.684161363854926, 0.6700762321049789, 0.6492281288865455, 0.6352731519497078, 0.6218622747368107, 0.60663076052157, 0.5994145483346272, 0.5922670934805658, 0.5830253276666546, 0.5803714114907608, 0.5799970033955181, 0.573664082877875, 0.5735249401622793, 0.5757700377240055, 0.5718641173092672, 0.5707445075413605, 0.5689819541598268, 0.5664692251483515, 0.5688256290481263, 0.5688514640463249)

baseSQ = c(1.0303382676844848, 0.9926738364665922, 0.9671447627656807, 0.9454121226482103, 0.9272970514355122, 0.9177787778466469, 0.9066441628497529, 0.8980641952822684, 0.895753509573336, 0.8918120639000278, 0.8883062274497779, 0.8906036918110963, 0.8892365081386655, 0.8880041810690394, 0.8910542993483183, 0.880826053688428, 0.8706856654121782, 0.8688230130248134, 0.8581266598546066, 0.8444771219993444, 0.8355044884075128, 0.8203675968294467, 0.8030529277978087, 0.7919369174589358, 0.7707061288662349, 0.7468161238013165, 0.7282522517792216, 0.7076325372629974, 0.6860306590557699, 0.661017022180154, 0.6424828078317988, 0.6268051599865055, 0.6087551217145551, 0.6007533882096882, 0.5978340845180314, 0.5904087337767259, 0.584511954182192, 0.5812170191628812, 0.5740519811534264, 0.5737400742886157, 0.5762218114357057, 0.5727345737246186, 0.5737631644063077, 0.5770335365996742, 0.5739573996160349, 0.5719015310912275, 0.5723970397355204, 0.570126976201013, 0.5715396841251225, 0.5728223512709675)

fd6SQ = c(1.0303382676844848, 0.9926738364665921, 0.9671447627656812, 0.9454121226482102, 0.9272970514355124, 0.9177787778466469, 0.9066441628497529, 0.8980641952822689, 0.8957535095733365, 0.8918120639000285, 0.8883062274497786, 0.8906036918110968, 0.8892365081386656, 0.8880041810690397, 0.8910542993483179, 0.8808260536884277, 0.8706856654121785, 0.8688230130248131, 0.8581266598546067, 0.8444771219993449, 0.8355044884075122, 0.8203675968294469, 0.8030529277978086, 0.7919369174589358, 0.7707061288662352, 0.7991301355381452, 0.8270573647902255, 0.8468155986508323, 0.8611778963287464, 0.8793834543962552, 0.8948848790511389, 0.8977989108871931, 0.9027879007423851, 0.9110207642716587, 0.9100648139424482, 0.912499071966404, 0.9180583236184567, 0.9162895918378721, 0.9140746784323699, 0.9146953403548941, 0.9105074324809822, 0.9053344812044463, 0.9019027573893224, 0.8933921951905199, 0.8807053705373605, 0.8721924029580742, 0.8663385502572009, 0.8593058018170949, 0.8537975525939357, 0.8523931523143627)

selfishSQ = c(1.0303382676844843, 0.9926738364665925, 0.9671447627656802, 0.94541212264821, 0.9272970514355118, 0.9177787778466466, 0.9066441628497526, 0.898064195282269, 0.895753509573336, 0.891812063900028, 0.8883062274497779, 0.8906036918110962, 0.8892365081386656, 0.88800418106904, 0.8910542993483186, 0.8808260536884278, 0.870685665412178, 0.868823013024813, 0.8581266598546077, 0.8444771219993443, 0.8355044884075126, 0.8203675968294469, 0.8030529277978087, 0.7919369174589355, 0.7707061288662348, 0.7497376569299214, 0.7387275461291434, 0.7389966936037156, 0.7446017644334338, 0.7490603899295883, 0.7525275322812256, 0.756333675547863, 0.7592405550287982, 0.762623095125041, 0.765528186225768, 0.7673137259141382, 0.76997299771765, 0.7725302857094956, 0.773305878788062, 0.7745408504896238, 0.7763260139934226, 0.7770658435470084, 0.7778415575887184, 0.7788417388337284, 0.7789783716427992, 0.7799498138929292, 0.7797664563131669, 0.7786253030741994, 0.7794494937481556, 0.7804983518629902)

twoYearsSQ = c(1.0303382676844843, 0.9926738364665921, 0.9671447627656803, 0.9454121226482088, 0.9272970514355119, 0.9177787778466466, 0.9066441628497526, 0.898064195282269, 0.8957535095733363, 0.8918120639000282, 0.888306227449778, 0.8906036918110966, 0.8892365081386655, 0.8880041810690388, 0.891054299348319, 0.880826053688428, 0.8706856654121788, 0.8688230130248128, 0.8581266598546075, 0.8444771219993447, 0.8355044884075128, 0.8203675968294467, 0.8030529277978088, 0.7919369174589354, 0.7707061288662349, 0.7457710665804229, 0.7230047917809698, 0.6940470713765035, 0.6738508757731638, 0.6523841629836318, 0.6359300463166327, 0.6208546448097302, 0.6119666411536603, 0.6050771912137727, 0.6013316828493073, 0.5930339460403561, 0.5904793281487639, 0.5860020702834732, 0.584683929116507, 0.5805599135658553, 0.5783610133568058, 0.5742329418843407, 0.5742994147744406, 0.571537215715543, 0.5719235766793409, 0.5701181395544123, 0.5714004734280982, 0.5687265028622471, 0.5690956580880272, 0.567338025016198)

grazingAASQ = c(1.030338267684484, 0.9926738364665921, 0.9671447627656814, 0.9454121226482105, 0.9272970514355121, 0.9177787778466466, 0.9066441628497526, 0.8980641952822684, 0.8957535095733361, 0.8918120639000285, 0.8883062274497772, 0.8906036918110958, 0.889236508138666, 0.8880041810690394, 0.8910542993483177, 0.880826053688428, 0.8706856654121785, 0.8688230130248126, 0.8581266598546071, 0.8444771219993444, 0.8355044884075128, 0.8203675968294464, 0.8030529277978086, 0.7919369174589356, 0.7707061288662352, 0.7468161238013167, 0.7493722324917838, 0.7623295061335753, 0.7736581266308661, 0.7863012478899348, 0.7942537949322581, 0.798301861633214, 0.8041521417268197, 0.8078151333734818, 0.8099761143055392, 0.8140196375215517, 0.8145593139886578, 0.7967788096755419, 0.7723243200240338, 0.750992696160902, 0.7340783730514298, 0.7209653050063876, 0.70883051727055, 0.6983914542141685, 0.6891460998235622, 0.6806831213359219, 0.6752087162726398, 0.669681329716894, 0.6644357788337237, 0.661777970542482)

#dataframe distribué par année 
#qsk3g1,qsk3,qsk3g3,qsk3g4,
#qsk2g1, qsk2, qsk2g3, qsk2g4
df2 <- data.frame(rf700SQ)
df2$years <- 1:nrow(df2)
df2 <- melt(df2, id.vars ="years")
df2$type <- "RF=700, t=25"


df3 <- data.frame(baseSQ)
df3$years <- 1:nrow(df3)
df3 <- melt(df3, id.vars ="years")
df3$type <- "Base"

df4 <- data.frame(fd6SQ)
df4$years <- 1:nrow(df4)
df4 <- melt(df4, id.vars ="years")
df4$type <- "FD=6, t=25"

df5 <- data.frame(selfishSQ)
df5$years <- 1:nrow(df5)
df5 <- melt(df5, id.vars ="years")
df5$type <- "No Loan, t=25"

df6 <- data.frame(twoYearsSQ)
df6$years <- 1:nrow(df6)
df6 <- melt(df6, id.vars ="years")
df6$type <- "Two years, t=25"


df7 <- data.frame(grazingAASQ)
df7$years <- 1:nrow(df7)
df7 <- melt(df7, id.vars ="years")
df7$type <- "Grazing Anywhere, anytime"

dfTot = rbind(df2,df4, df5, df6, df7, df3)

ggplot(dfTot, aes(x=years))+
  geom_line( aes(y=value, color=variable))+
  theme_minimal()+
  xlab("Years")+
  ylab("Soil quality")+
  geom_vline(xintercept=25, linetype='dotted', col = 'black')+
  scale_color_manual(name = "Switch, Years = 25", 
                     values=c( "blue", "darkgreen","#D95F02", "purple", "#1B9E77", "red" ),
                     labels=c("Rainfall = 700mm", "6 Faidherbia/ha","No Loan, no food donation", "2 years rotation", "Grazing anywhere anytime", "Base"))

