library(ggplot2)
library(reshape2)
library(scales)
library(dplyr)

datapop = c(358, 371, 384, 378, 368, 370, 363, 386, 408, 409, 411, 411, 402,417, 434, 455, 450, 460, 477, 468, 467, 466, 475, 487, 492, 488)
asq= c(99.26976371578736, 98.2797637157873, 97.29223902636254, 96.3293647157878, 95.36876870578742, 94.41035396646221, 93.47629850648619, 92.54423315857984, 91.6016892923508, 90.70797121666789, 89.76399079805739, 88.90082619797562, 88.0218660156842, 87.13444540678451, 86.26817449049128, 85.4155408252751, 84.56408305418073, 83.60729462294056, 82.88415120287115, 81.99363527068239, 81.05198350932982, 80.39817411904083, 79.5148719458226, 78.6890840080023, 77.89845607424478, 77.11073512894517)
rsq = c(99.0, 98.00999999999932, 97.02990000000048, 96.0596010000006, 95.09900498999947, 94.14801494009971, 93.2065347906983, 92.27446944279266, 91.35172474836432, 90.43820750088001, 89.53382542587138, 88.63848717161352, 87.75210229989634, 86.87458127689757, 86.00583546412938, 85.14577710948734, 84.29431933839332, 83.45137614500818, 82.6168623835584, 81.79069375972267, 80.97278682212618, 80.16305895390514, 79.36142836436555, 78.56781408072153, 77.78213593991426, 77.00431458051507)
herd = c(86.7, 86.3, 86.45, 86.3, 86.55, 86.5, 86.4, 86.25, 86.8, 86.45, 86.85, 87.1, 87.05, 87.3, 87.65, 87.75, 87.15, 88.25, 87.85, 87.0, 89.0, 88.6, 88.55, 88.5, 88.1)
ef = c(1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.9528301886792453, 1.0, 0.8532110091743119, 1.0, 1.0, 0.963302752293578, 1.0, 1.0, 1.0, 0.5943396226415094, 0.9908256880733946, 0.7522935779816514, 0.3018867924528302, 0.8715596330275229, 0.5688073394495413, 0.46226415094339623, 0.43119266055045874, 0.3944954128440367)
pop = c(367, 372, 377, 382, 387, 392, 397, 402, 407, 412, 417, 423, 429, 435, 441, 447, 453, 459, 465, 471, 477, 483, 489, 496, 503, 510)
milletYield = c(671.5258438684785, 876.643196898558, 642.4150995818216, 643.164698722602, 610.3053631047513, 919.925307929242, 839.878757323897, 733.2510408313086, 617.1074265957363, 708.9023430949885, 590.6916049709588, 815.1090647534343, 741.0673961530986, 705.4894843422593, 808.1669563111152, 835.4714441601137, 833.1715916934618, 589.36754606657, 831.5190720848015, 675.7548102689137, 505.8820641807095, 817.032936183339, 659.2787188760437, 646.5072091777522, 617.0637340725164, 619.3065835827723)
nitrogen = c(35.5, 54.089603719494086, 54.83347592876591, 54.60622708111358, 53.877071974559904, 53.66063642259308, 55.84079498234816, 54.74126950542411, 53.784093212716535, 54.30895186336575, 53.98753047137008, 53.57257551306757, 54.50132339737705, 53.82850879791202, 53.77129751918683, 54.38335577893952, 53.979611367470575, 54.01648588062523, 54.522802511567384, 53.14729838661965, 53.72338667014681, 53.58852300732319, 52.57696178902409, 53.52656290442535, 53.48812548412847, 52.82743600708944)
rainfall = c(623,623,404,408,388,729,620,528,394,484,395,635,540,526,652,691,720,416,723,536,353,767,527,509,501,501)
fs = c(1.205855692847934, 1.3979329123521842, 1.151194809783664, 1.1239856561072157, 1.0784629230471778, 1.3586521081890035, 1.2705667623063255, 1.1602628051298634, 1.0555657693917073, 1.1019651576371687, 1.0431568092512857, 1.1755463377694897, 1.0800494990012963, 1.0609685038870225, 1.1209075101443717, 1.1205776971601944, 1.1087752718681283, 1.0582560575237592, 1.0706358160669447, 1.0479126888538417, 1.0439016543288269, 1.0743489725722217, 1.072006531597895, 1.0906310202983038, 1.065001896855072, 1.064864672097866)
loaned = c(5.0918012, 7.9558848000000015, 13.476420000000001, 19.175839200000002, 17.294335200000003, 7.8841476, 14.282856, 14.5778256, 20.3694588, 19.2856464, 24.2934948, 15.240801600000003, 22.181158800000006, 18.905047200000002, 17.6469516, 21.577802400000003, 17.1389664, 35.7514596, 23.125500000000002, 29.077192800000002, 50.829264, 28.1978424, 39.8663784, 42.515949600000006, 46.484798399999995, 47.7575604)

plot( milletYield, type="b" , bty="l" , xlab="Years" , ylab="Millet yield" , col=rgb(0.2,0.4,0.1,0.7) , lwd=3 , pch=21 , ylim=c(500,950) )
plot( nitrogen, type="b" , bty="l" , xlab="Years" , ylab="Nitrogen" , col=rgb(0.2,0.4,0.1,0.7) , lwd=3 , pch=21 , ylim=c(50,60) )
plot( pop, type="b" , bty="l" , xlab="Years" , ylab="Population" , col=rgb(0.2,0.4,0.1,0.7) , lwd=3 , pch=21 , ylim=c(300,550) )
plot( herd, type="b" , bty="l" , xlab="Years" , ylab="Herd size" , col=rgb(0.2,0.4,0.1,0.7) , lwd=3 , pch=21 , ylim=c(70,100) )
plot( fs, type="b" , bty="l" , xlab="Years" , ylab="Food stress" , col=rgb(0.2,0.4,0.1,0.7) , lwd=3 , pch=21 , ylim=c(0.5,1.5) )
plot(loaned, type="b" , bty="l" , xlab="Years" , ylab="Loaned parcel area" , col=rgb(0.2,0.4,0.1,0.7) , lwd=3 , pch=21 , ylim=c(0.0,60.0) )
plot( asq, type="b" , bty="l" , xlab="Years" , ylab="Annual soil quality" , col=rgb(0.2,0.4,0.1,0.7) , lwd=3 , pch=21 , ylim=c(70,102) )

par(new=TRUE, mar=c(3,4,2,5))
plot( rsq, type="b" , bty="l" , xlab="Years" , ylab="Annual soil quality" , col=rgb(0.2,0.4,0.1,0.7) , lwd=3 , pch=21 , ylim=c(70,102) )
par(new=TRUE)
plot( ef, type="b" , bty="l" , xlab="Years" , ylab="Effective fallow ratio" , col=rgb(0.2,0.4,0.1,0.7) , lwd=3 , pch=21 , ylim=c(0.2,1.1) )

#plot( rainfall, type="b"  , xlab="" , ylab="", col=rgb(0.2,0.4,0.9,0.7) , lwd=2 , pch=21 , ylim=c(250,800), axes=FALSE)
#par(new=TRUE)
#plot( datapop, type="b"  , xlab="" , ylab="", col=rgb(0.9,0.2,0.1,0.7) , lwd=2 , pch=21 , ylim=c(300,550), axes=FALSE)

mtext("Rain fall",side=4,col=rgb(0.2,0.4,0.9,0.7),line=4) 
axis(4, ylim=c(400,1000), col="black",col.axis="black")

#lines( fs, type="b" , bty="l" , xlab="Year" , ylab="Yield" , col=rgb(0.9,0.8,0.3,0.7) , lwd=3 , pch=21 , ylim=c(0,1.5) )
#plot(globalneeds, type="b" , bty="l" , xlab="Year" , ylab="Global needs" , col=rgb(0.2,0.1,0.3,0.7) , lwd=3 , pch=21 , ylim=c(0,100000) )
#plot(loanneeds, type="b" , bty="l" , xlab="Year" , ylab="Loan needs" , col=rgb(0.9,0.3,0.3,0.7) , lwd=3 , pch=21 , ylim=c(0,100000), add=TRUE)

#curve(0.501 * log(x) - 1.2179, from=18, to=83, , xlab="x", ylab="yield")