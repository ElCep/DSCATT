
pop<-c(479, 479, 482, 481, 482, 487, 488, 486, 485, 485, 486, 486, 482, 483, 480, 479, 477, 480, 480, 481, 480, 482, 483, 484, 487, 486)
herd<-c(165, 170, 174, 161, 168, 171, 163, 166, 165, 159, 163, 164, 158, 161, 161, 156, 165, 160, 155, 163, 161, 158, 164, 158, 157, 164)
fallow<-c(0.47572815533980584, 0.514018691588785, 0.49074074074074076, 0.44660194174757284, 0.48598130841121495, 0.4537037037037037, 0.44660194174757284, 0.4485981308411215, 0.4351851851851852, 0.42718446601941745, 0.4392523364485981, 0.4351851851851852, 0.4368932038834951, 0.4392523364485981, 0.42592592592592593, 0.4368932038834951, 0.4672897196261682, 0.4351851851851852, 0.42718446601941745, 0.42990654205607476, 0.4444444444444444, 0.4368932038834951, 0.4485981308411215, 0.4351851851851852, 0.4368932038834951, 0.4392523364485981)
foodStress<- c(1.014617306865746, 1.0207093522897925, 1.0287911184759855, 1.017428038226491, 1.0170198546733797, 1.0215425139375125, 1.0110767843951975, 1.0111533343596335, 1.0120649709621292, 1.0117226176853733, 1.0139360554172203, 1.0155362090251334, 1.0052755174076555, 1.0198360150444334, 1.0089459791320934, 1.0156400931795369, 1.0119898258704363, 1.0251721828855662, 1.0182167385031486, 1.0229273001592223, 1.0078873078163078, 1.0203760794700196, 1.0173126994676371, 1.0163238863501833, 1.0170481552456203, 1.014953207720883)
yeild <- c(711.7672932750596, 720.511941023104, 717.3792675374622, 716.2715104509623, 721.2478335245875, 703.5685361766414, 713.4851055698847, 714.2094581171591, 697.4621166778205, 702.8520083480394, 708.2430593553904, 694.3057096929049, 701.7240025569631, 708.2932540550815, 689.4235005119325, 697.575738358516, 705.9192933237231, 693.1699762459345, 688.7263070345564, 704.6005656486329, 693.0998268336539, 694.8153640165489, 706.1480194264694, 693.0909257400085, 693.4850235281848, 698.186996068203)
type <- "mulching0"
year <- factor(seq(1, length(pop),by=1))
mulching0 <- cbind(pop, herd, fallow, foodStress, yeild,type, year)


pop<-c(487, 493, 496, 497, 498, 499, 501, 501, 505, 505, 505, 510, 509, 508, 511, 509, 510, 510, 509, 512, 512, 508, 509, 507, 509, 508)
herd<-c(148, 158, 161, 148, 154, 157, 144, 150, 148, 144, 143, 144, 139, 142, 138, 138, 137, 139, 137, 138, 133, 127, 135, 135, 127, 138)
fallow<-c(0.5533980582524272, 0.5887850467289719, 0.6018518518518519, 0.5145631067961165, 0.5514018691588785, 0.5740740740740741, 0.4563106796116505, 0.514018691588785, 0.5, 0.4368932038834951, 0.4485981308411215, 0.4537037037037037, 0.4174757281553398, 0.411214953271028, 0.4166666666666667, 0.4174757281553398, 0.3925233644859813, 0.42592592592592593, 0.4077669902912621, 0.3925233644859813, 0.3888888888888889, 0.3592233009708738, 0.4205607476635514, 0.39814814814814814, 0.34951456310679613, 0.4392523364485981)
foodStress<-c(1.0342648531601186, 1.0291830287334645, 1.0286792808983818, 1.0313386141124414, 1.0147329905814584, 1.0149093969442156, 1.0265864745628974, 1.0141923835480964, 1.0227155606884808, 1.0115987896130811, 1.0116416964274924, 1.0174035205490894, 1.004909193252437, 1.0109508794902091, 1.0165307662586258, 1.005161204981661, 1.0178377654265118, 1.0131164319881123, 1.0061680595792086, 1.0143083748280362, 1.0210942011015773, 1.0120679351953565, 1.0152487669247088, 1.0106888309449817, 1.023984035313499, 1.010483565546477)
yeild <- c(766.4289882996677, 782.1695877416944, 789.1382281734109, 779.2156583105152, 775.8932256214987, 774.0399498395352, 754.286875907698, 769.2445760308209, 760.0475665539528, 748.033062963014, 746.2124969323054, 749.1483138516007, 740.0022108603606, 741.0509635820991, 731.6053444364187, 741.1129937991801, 735.8778742235322, 734.731675701302, 736.6908613997828, 733.9083951517424, 729.7868530750887, 727.3706430385, 733.590273101745, 724.0565075636229, 725.7107339662908, 739.9319269321267)
type <- "mulching_20"
mulching20 <- cbind(pop, herd, fallow, foodStress, yeild, type, year)


pop<-c(487, 492, 499, 505, 507, 514, 520, 522, 526, 524, 525, 529, 531, 529, 530, 535, 534, 533, 536, 536, 533, 532, 532, 528, 534, 535)
herd<-c(127, 132, 131, 119, 124, 122, 115, 119, 120, 115, 115, 115, 110, 114, 113, 110, 107, 105, 106, 106, 100, 103, 103, 100, 105, 105)
fallow<-c(0.6116504854368932, 0.6448598130841121, 0.6296296296296297, 0.4854368932038835, 0.5420560747663551, 0.5092592592592593, 0.42718446601941745, 0.42990654205607476, 0.4537037037037037, 0.42718446601941745, 0.40186915887850466, 0.4074074074074074, 0.36893203883495146, 0.35514018691588783, 0.4166666666666667, 0.32038834951456313, 0.3177570093457944, 0.3333333333333333, 0.3106796116504854, 0.308411214953271, 0.32407407407407407, 0.2912621359223301, 0.2803738317757009, 0.3425925925925926, 0.2912621359223301, 0.2897196261682243)
foodStress<-c(1.0369669081913815, 1.0367751790399138, 1.0412922774802453, 1.0438419835242494, 1.0238412769609413, 1.0363038186688132, 1.0230879738340926, 1.0115800235486705, 1.0258985925045043, 1.0055177042211059, 1.012143814410636, 1.0229545937072055, 1.0171431264054676, 1.015152996674739, 1.0152182335548086, 1.029737468645753, 1.0089379041649251, 1.015312427647501, 1.0243905027426605, 1.0107571508378597, 1.0123113189889636, 1.0197107562831207, 1.0319797378875832, 1.014702574191534, 1.029256128722726, 1.0282922551497033)
yeild <- c(799.9271185534865, 816.6505472339957, 821.4974324139162, 791.5438861256929, 796.4942426716536, 797.5067363827601, 779.3039704076597, 772.9324461477644, 788.2133688265409, 779.8623122879502, 770.8304284376076, 779.6925145412143, 760.3710362406957, 759.5270760832318, 780.3704920852381, 758.5161647715105, 756.9583568775511, 753.4151001706049, 741.0735247570028, 747.6796131119874, 742.7689021433345, 736.5388753211331, 748.1720423758105, 748.8309499918655, 733.3014697375257, 747.5659397947754)
type <- "mulching_40"

mulching40 <- cbind(pop, herd, fallow, foodStress, yeild, type, year)

pop<-c(486, 495, 502, 508, 511, 517, 518, 521, 525, 525, 526, 528, 527, 526, 527, 528, 526, 531, 534, 534, 530, 533, 538, 540, 539, 541)
herd<-c(90, 92, 94, 84, 86, 90, 84, 83, 85, 81, 80, 79, 73, 76, 75, 75, 73, 77, 73, 66, 77, 73, 67, 73, 74, 67)
fallow<-c(0.5631067961165048, 0.5981308411214953, 0.5462962962962963, 0.46601941747572817, 0.514018691588785, 0.5092592592592593, 0.4174757281553398, 0.4485981308411215, 0.46296296296296297, 0.39805825242718446, 0.40186915887850466, 0.4074074074074074, 0.34951456310679613, 0.37383177570093457, 0.39814814814814814, 0.39805825242718446, 0.35514018691588783, 0.4074074074074074, 0.33980582524271846, 0.27102803738317754, 0.4074074074074074, 0.33980582524271846, 0.2803738317757009, 0.3425925925925926, 0.33980582524271846, 0.29906542056074764)
foodStress<-c(1.0571648169656611, 1.0399233403816368, 1.0545741833026443, 1.0405412165649588, 1.0247208982180136, 1.0318652774509103, 1.018460738251087, 1.0196935395640085, 1.0270528488982056, 1.0113736646705278, 1.009575672777989, 1.0266564836294707, 1.024843368912537, 1.0174894180645944, 1.027335951817285, 1.0115368308757082, 1.0065066522752628, 1.0264777171308381, 1.0265372611819463, 1.0133723575705793, 1.014596321676186, 1.0246132786468922, 1.0326278838430352, 1.0234959521518683, 1.0145467362951417, 1.025793518776146)
yeild <- c(796.8520214881827, 795.7749687731084, 806.824461669985, 781.2443887505016, 790.2235276009759, 803.1862120887417, 781.2357914486178, 779.8434850409068, 788.8260320977247, 771.1688211988258, 771.1266607124514, 771.1508770971335, 752.1329412214485, 767.8070182035661, 768.9068839109277, 760.9031083214974, 758.9137093481186, 768.226959994431, 754.4927754935162, 729.1879896523599, 768.6663606332268, 755.9730279041734, 744.9324179536571, 755.9325838655791, 764.9461740006736, 748.1372079357886)
type <- "mulching_60"

mulching60 <- cbind(pop, herd, fallow, foodStress, yeild, type, year)

pop<-c(486, 493, 500, 506, 511, 517, 518, 522, 527, 530, 533, 533, 531, 531, 534, 535, 528, 529, 529, 530, 530, 535, 537, 535, 537, 540)
herd<-c(71, 81, 79, 66, 73, 74, 64, 70, 70, 58, 63, 64, 57, 61, 61, 57, 61, 56, 56, 55, 58, 54, 53, 53, 56, 51)
fallow<-c(0.5339805825242718, 0.5981308411214953, 0.5462962962962963, 0.47572815533980584, 0.514018691588785, 0.49074074074074076, 0.4174757281553398, 0.4392523364485981, 0.46296296296296297, 0.34951456310679613, 0.38317757009345793, 0.4074074074074074, 0.32038834951456313, 0.37383177570093457, 0.39814814814814814, 0.3300970873786408, 0.35514018691588783, 0.37962962962962965, 0.3300970873786408, 0.3364485981308411, 0.37962962962962965, 0.30097087378640774, 0.3177570093457944, 0.3333333333333333, 0.32038834951456313, 0.29906542056074764)
foodStress<-c(1.0599836110784502, 1.0363205871366363, 1.0556227884548128, 1.037815167570554, 1.0248358108792694, 1.0342767763074827, 1.0111600919392263, 1.018661426820039, 1.0289581104112977, 1.0167937486612133, 1.0123863652156786, 1.0076777564208728, 1.0125640004814365, 1.0058289258485367, 1.022085128823193, 1.0123345419402625, 1.0014741480367835, 1.0230091126855452, 1.0109282429227642, 1.0220160261781288, 1.008972452862782, 1.028947171280254, 1.0204828783422797, 1.0093439286666925, 1.0193498122308622, 1.025376384806088)
yeild <- c(781.9164872497233, 793.2779343829509, 804.0703771254177, 779.2769939496266, 782.9429000012987, 800.3580348968112, 779.0925376282212, 773.1194516504313, 796.7977537320382, 765.643123772508, 770.5077804552838, 773.7290598987962, 748.8006617782097, 759.0597330171082, 767.8314319184336, 747.5470817826916, 760.1085946386398, 750.4018154437316, 736.9012737422778, 757.7587667537317, 749.7140548672883, 734.0083148318754, 748.3395400024159, 741.5196976645635, 746.8137780905356, 746.1770416468672)
type <- "mulching_70"
mulching70 <- cbind(pop, herd, fallow, foodStress, yeild, type, year)


pop<-c(488, 494, 501, 508, 513, 521, 521, 524, 527, 526, 528, 531, 531, 530, 531, 530, 528, 530, 533, 535, 534, 536, 537, 539, 538, 539)
herd<-c(53, 64, 60, 52, 55, 56, 49, 51, 49, 43, 46, 44, 39, 43, 40, 42, 41, 37, 37, 37, 36, 33, 33, 30, 31, 35)
fallow<-c(0.49514563106796117, 0.5887850467289719, 0.5277777777777778, 0.47572815533980584, 0.4766355140186916, 0.5, 0.4077669902912621, 0.4205607476635514, 0.4351851851851852, 0.34951456310679613, 0.38317757009345793, 0.39814814814814814, 0.32038834951456313, 0.3644859813084112, 0.3888888888888889, 0.3592233009708738, 0.34579439252336447, 0.35185185185185186, 0.30097087378640774, 0.32710280373831774, 0.3333333333333333, 0.2815533980582524, 0.29906542056074764, 0.3148148148148148, 0.2621359223300971, 0.3177570093457944)
foodStress<-c(1.0584865568903394, 1.032646841059671, 1.0566047989095144, 1.0279108159496468, 1.0246834418729034, 1.0281248917878245, 1.0067099973908125, 1.0133962883563774, 1.016086341300514, 1.0114806210603022, 1.0133890448794924, 1.0168059589467486, 1.015541211143981, 1.0121249943729391, 1.0216754194224984, 1.0161889575829, 1.0149153586161797, 1.0232825695666485, 1.0268340843670636, 1.0195974622729491, 1.0205922801857799, 1.0294955678890076, 1.0207699527834828, 1.022240451938096, 1.031944617222465, 1.0256323333444728)
yeild <- c(763.6084531456457, 785.8981734350244, 796.8115023763229, 777.7823354084875, 773.3645926444352, 800.7428918475666, 773.1823461449153, 768.6699847311771, 786.925833644989, 752.6854965190788, 762.8368439504037, 768.1961748538162, 740.3175475665822, 765.1017256276002, 768.7362678620702, 750.4517277723686, 753.4196519804707, 753.0373276087275, 738.1333537826423, 756.3966765071013, 743.5183601542976, 724.7353016467066, 752.1488645262548, 753.0979748723664, 728.3735964626202, 750.1501795142663)
type <- "mulching_80"
mulching80 <- cbind(pop, herd, fallow, foodStress, yeild, type, year)

pop<-c(485, 489, 497, 502, 506, 513, 515, 514, 517, 519, 523, 523, 521, 522, 525, 524, 525, 527, 532, 527, 527, 530, 531, 530, 535, 534)
herd<-c(26, 40, 30, 26, 31, 30, 25, 28, 29, 21, 25, 27, 20, 26, 23, 16, 24, 21, 14, 24, 20, 15, 19, 19, 14, 17)
fallow<-c(0.4077669902912621, 0.5887850467289719, 0.49074074074074076, 0.4563106796116505, 0.4672897196261682, 0.48148148148148145, 0.4077669902912621, 0.3925233644859813, 0.46296296296296297, 0.36893203883495146, 0.35514018691588783, 0.42592592592592593, 0.34951456310679613, 0.3644859813084112, 0.3888888888888889, 0.30097087378640774, 0.3364485981308411, 0.35185185185185186, 0.2815533980582524, 0.34579439252336447, 0.3333333333333333, 0.30097087378640774, 0.308411214953271, 0.3425925925925926, 0.2815533980582524, 0.2897196261682243)
foodStress<-c(1.0357611701485403, 1.0335850370616728, 1.0595806834837507, 1.0345249714246312, 1.023931130206294, 1.0316648420768424, 1.0115569444160148, 1.0137503227849989, 1.0187942663378209, 1.0170189718198503, 1.0197572769661356, 1.0125539966281356, 1.011478896246564, 1.0168874310355633, 1.0216327795682372, 1.010683095393212, 1.0134713213036899, 1.0293362169245837, 1.025781091797697, 1.006817787314791, 1.0211958731681539, 1.0247987785810229, 1.0174794871688064, 1.024300818750202, 1.025636590220253, 1.016258491635852)
yeild <- c(714.9029918105164, 780.9325093515769, 776.80590350751, 762.7186672500918, 761.2591577674187, 787.9845876741728, 755.3164808766693, 748.9663878130989, 776.539830678101, 752.325354665192, 744.5832442232983, 764.4660743362955, 747.4490947962502, 747.1946963387443, 767.513790803342, 727.6943044776253, 736.8495888911478, 756.0003195762145, 731.0992880178984, 749.1077121146855, 750.104034630733, 735.6355218913113, 741.5112753683877, 761.6242857647347, 725.6836048409491, 735.8990426167118)
type <- "mulching_100"
mulching100 <- cbind(pop, herd, fallow, foodStress, yeild, type,year)


df<- as.data.frame(rbind(mulching0,mulching20,mulching40,mulching60,mulching70,mulching80,mulching100))
for(i in 1:length(df[,c(-6,-7)])){
  print(i)
  df[,i]<-as.numeric(df[,i])
}
# Réordonner les facteurs de la colonne type
df$type <- factor(df$type, levels = c("mulching0", "mulching_20", "mulching_40", 
                                      "mulching_60", "mulching_70", "mulching_80", 
                                      "mulching_100"))
levels(df$type)


ggplot(df, aes(x = fallow, y = pop, color = type, label=year )) +
  geom_path() +
  geom_point()+
  geom_label()+
  facet_wrap(vars(type))+
  theme_bw() +  # Utiliser un thème en noir et blanc
  theme(legend.position = "none")  # Supprimer la légende


melt.df <- reshape2::melt(df, id=c("year", "type"))

ggplot(melt.df, aes(x = year, y = value, color = variable, group = type )) +
  geom_line()+
  geom_point()+
  facet_wrap(vars(type))+
  theme_bw()  # Utiliser un thème en noir et blanc

